<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cal-Ender</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="app-header">
      <div>
        <h1>Cal-Ender</h1>
        <p class="subtitle">Plan tasks, map milestones, balance projects.</p>
      </div>
      <div class="user-info">
        <span id="user-email">Not signed in</span>
        <button id="sign-out" class="secondary" type="button" hidden>Sign out</button>
      </div>
    </header>

    <main class="app">
      <section id="auth-section" class="panel">
        <h2>Sign in</h2>
        <div class="form-grid">
          <label>
            Email
            <input id="auth-email" type="email" autocomplete="email" />
          </label>
          <label>
            Password
            <input id="auth-password" type="password" autocomplete="current-password" />
          </label>
        </div>
        <div class="actions">
          <button id="sign-in" type="button">Sign in</button>
          <button id="sign-up" class="secondary" type="button">Create account</button>
        </div>
        <p class="helper" id="auth-message"></p>
      </section>

      <section id="app-section" class="panel" hidden>
        <div class="tabs">
          <button class="tab-button active" data-tab-target="calendar-tab" type="button">
            Calendar
          </button>
          <button class="tab-button" data-tab-target="today-tab" type="button">Today</button>
          <button class="tab-button" data-tab-target="add-tab" type="button">Add Tasks</button>
        </div>

        <div class="toolbar">
          <div class="toolbar-group">
            <label>
              Day view
              <input id="day-picker" type="date" />
            </label>
            <button id="refresh-day" class="secondary" type="button">Refresh</button>
            <button id="auto-schedule" type="button">Auto schedule</button>
          </div>
          <div class="toolbar-group focus-controls">
            <label class="checkbox">
              <input id="focus-toggle" type="checkbox" />
              High Focus
            </label>
            <label>
              Focus project
              <select id="focus-project"></select>
            </label>
            <span class="stat" id="focus-status">Neutral</span>
          </div>
          <div class="toolbar-group">
            <span class="stat" id="day-total">0 tasks</span>
            <span class="stat" id="day-duration">0h</span>
          </div>
        </div>

        <section id="calendar-tab" class="tab-content active" data-tab-content>
          <div class="layout">
            <section class="card">
              <div class="month-header">
                <button id="month-prev" class="secondary" type="button">Prev</button>
                <h3 id="month-label">Month</h3>
                <button id="month-next" class="secondary" type="button">Next</button>
              </div>
              <div id="month-grid" class="calendar-grid"></div>
            </section>

            <section class="card day-view-card" id="day-view-card">
              <h3 id="selected-day-label">Day view</h3>
              <div id="day-map" class="timeline"></div>
              <h3>Fixed events</h3>
              <div id="fixed-events"></div>
              <h3>Milestones</h3>
              <div id="milestones"></div>
              <h3>Workload balance</h3>
              <div id="balance"></div>
            </section>
          </div>
        </section>

        <section id="today-tab" class="tab-content" data-tab-content hidden>
          <div class="layout">
            <section class="card">
              <h3>Today: hourly focus</h3>
              <div id="today-map" class="hourly"></div>
            </section>
            <section class="card">
              <h3>Today summary</h3>
              <div id="today-summary"></div>
            </section>
          </div>
        </section>

        <section id="add-tab" class="tab-content" data-tab-content hidden>
          <div class="layout">
            <section class="card">
              <h3>Add a single task</h3>
              <form id="task-form">
                <div class="form-grid">
                  <label>
                    Task title
                    <input id="task-title" type="text" required />
                  </label>
                  <label>
                    Project
                    <select id="task-project-id"></select>
                  </label>
                  <label>
                    Company
                    <input id="task-company" type="text" placeholder="MBC" />
                  </label>
                  <label>
                    Project
                    <input id="task-project" type="text" placeholder="HighLevel integration" />
                  </label>
                  <label>
                    Day
                    <input id="task-date" type="date" required />
                  </label>
                  <label>
                    Start
                    <input id="task-start" type="time" />
                  </label>
                  <label>
                    End
                    <input id="task-end" type="time" />
                  </label>
                  <label>
                    Est. hours
                    <input id="task-hours" type="number" step="0.25" min="0" placeholder="2.5" />
                  </label>
                  <label>
                    Priority (1-3)
                    <input id="task-priority" type="number" min="1" max="3" value="2" />
                  </label>
                  <label>
                    Deadline type
                    <select id="task-deadline-type">
                      <option value="">None</option>
                      <option value="soft">Soft</option>
                      <option value="hard">Hard</option>
                    </select>
                  </label>
                  <label>
                    Deadline date
                    <input id="task-deadline-date" type="date" />
                  </label>
                  <label>
                    Dependencies (task IDs, comma separated)
                    <input id="task-dependencies" type="text" placeholder="uuid, uuid" />
                  </label>
                </div>
                <label class="checkbox">
                  <input id="task-milestone" type="checkbox" />
                  Milestone
                </label>
                <label>
                  Notes
                  <textarea id="task-notes" rows="3" placeholder="Optional details"></textarea>
                </label>
                <div class="actions">
                  <button type="submit">Add task</button>
                </div>
                <p class="helper" id="task-message"></p>
              </form>
            </section>

            <section class="card">
              <h3>Bulk import tasks</h3>
              <p class="helper">
                Format: <code>YYYY-MM-DD | Company | Project | Title #milestone est=2.5</code>
                <span class="helper">Separators: |  _  ::  tab, or 2+ spaces. Line breaks: newline or ;;.</span>
              </p>
              <textarea id="bulk-input" rows="8" placeholder="Add one task per line"></textarea>
              <div class="actions">
                <button id="bulk-import" type="button">Import tasks</button>
              </div>
              <p class="helper" id="bulk-message"></p>
            </section>

            <section class="card">
              <h3>Add a project</h3>
              <form id="project-form">
                <div class="form-grid">
                  <label>
                    Project title
                    <input id="project-title" type="text" required />
                  </label>
                  <label>
                    Description
                    <textarea id="project-description" rows="2"></textarea>
                  </label>
                  <label>
                    Priority (1-3)
                    <input id="project-priority" type="number" min="1" max="3" value="2" />
                  </label>
                  <label>
                    Deadline type
                    <select id="project-deadline-type">
                      <option value="">None</option>
                      <option value="soft">Soft</option>
                      <option value="hard">Hard</option>
                    </select>
                  </label>
                  <label>
                    Deadline date
                    <input id="project-deadline-date" type="date" />
                  </label>
                </div>
                <div class="actions">
                  <button type="submit">Add project</button>
                </div>
                <p class="helper" id="project-message"></p>
              </form>
            </section>

            <section class="card">
              <h3>Add a fixed event</h3>
              <form id="event-form">
                <div class="form-grid">
                  <label>
                    Title
                    <input id="event-title" type="text" required />
                  </label>
                  <label>
                    Day
                    <input id="event-date" type="date" required />
                  </label>
                  <label>
                    Start
                    <input id="event-start" type="time" required />
                  </label>
                  <label>
                    End
                    <input id="event-end" type="time" required />
                  </label>
                </div>
                <div class="actions">
                  <button type="submit">Add event</button>
                </div>
                <p class="helper" id="event-message"></p>
              </form>
            </section>

            <section class="card">
              <h3>Work hours</h3>
              <form id="work-hours-form">
                <div class="form-grid">
                  <label>
                    Start
                    <input id="work-start" type="time" value="09:00" />
                  </label>
                  <label>
                    End
                    <input id="work-end" type="time" value="17:00" />
                  </label>
                  <label>
                    Break length (minutes)
                    <input id="break-length" type="number" min="5" max="60" value="15" />
                  </label>
                </div>
                <div class="actions">
                  <button type="submit">Save work hours</button>
                </div>
                <p class="helper" id="work-hours-message"></p>
              </form>
            </section>

            <section class="card">
              <h3>External calendar (read-only)</h3>
              <p class="helper">
                Use a public Google Calendar with an API key to import fixed events.
              </p>
              <form id="calendar-import-form">
                <div class="form-grid">
                  <label>
                    Google API key
                    <input id="google-api-key" type="text" />
                  </label>
                  <label>
                    Calendar ID
                    <input id="google-calendar-id" type="text" placeholder="example@group.calendar.google.com" />
                  </label>
                </div>
                <div class="actions">
                  <button type="submit">Import events</button>
                </div>
                <p class="helper" id="calendar-import-message"></p>
              </form>
            </section>

            <section class="card">
              <h3>AI task breakdown (lightweight)</h3>
              <p class="helper">Paste a project description and get a draft task list.</p>
              <textarea id="ai-input" rows="6" placeholder="Describe the project..."></textarea>
              <div class="actions">
                <button id="ai-breakdown" type="button">Generate tasks</button>
              </div>
              <p class="helper" id="ai-message"></p>
            </section>
          </div>
        </section>
      </section>
    </main>

    <script type="module" src="./app.js"></script>
  </body>
</html>
